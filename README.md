# ConfirmationBot

## –û–ø–∏—Å–∞–Ω–∏–µ
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞. –í—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é, –∑–∞–≥—Ä—É–∑–∫—É Excel-—Ñ–∞–π–ª–∞, –∏—Å–ø–æ–ª—å–∑—É—è –∑–∞–¥–∞–Ω–Ω—É—é –≤ config.json –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–æ–ª–µ–π. –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã (—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ Telegram-–≥—Ä—É–ø–ø—É.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.8+
- Windows/Linux
- [requests](https://pypi.org/project/requests/)
- [python-dotenv](https://pypi.org/project/python-dotenv/)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ GitHub
```bash
git clone https://github.com/it-tirador/ConfirmationBot.git
cd ConfirmationBot
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ConfirmationBot/
‚îú‚îÄ‚îÄ main.py               # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ config.json           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª (–ø—É—Ç–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–ª–æ–Ω–æ–∫)
‚îú‚îÄ‚îÄ requirements.txt      # –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Python
‚îú‚îÄ‚îÄ .env                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞)
‚îú‚îÄ‚îÄ app.log               # –õ–æ–≥-—Ñ–∞–π–ª —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞
‚îú‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ source/               # –ö–∞—Ç–∞–ª–æ–≥ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# –î–∞–Ω–Ω—ã–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
LOGIN=–≤–∞—à_–ª–æ–≥–∏–Ω
PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å

# –ë–∞–∑–æ–≤—ã–π URL —Å–∞–π—Ç–∞
BASE_URL=https://example.com

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram-–±–æ—Ç–∞
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
BOT_CHAT_ID=id_—á–∞—Ç–∞
BOT_THREAD_ID=id_—Ç–µ–º—ã
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `config.json`:

```json
{
    "confirmation_file_path": "source\N1_180725_20510595.xls",
    "order_id_col": 1,
    "quantity_col": 5,
    "order_product_id_col": 8
}
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–µ–π:**
- `order_id_col` ‚Äî –Ω–æ–º–µ—Ä –∫–æ–ª–æ–Ω–∫–∏ —Å "‚Ññ –∑–∞–∫–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–∞" (–Ω–∞—á–∏–Ω–∞—è —Å 0)
- `quantity_col` ‚Äî –Ω–æ–º–µ—Ä –∫–æ–ª–æ–Ω–∫–∏ —Å "–ö–æ–ª-–≤–æ" 
- `order_product_id_col` ‚Äî –Ω–æ–º–µ—Ä –∫–æ–ª–æ–Ω–∫–∏ —Å "–ö–æ–¥ –ø–æ–∑–∏—Ü–∏–∏"

–£–∫–∞–∂–∏—Ç–µ –ø–æ—Ä—è–¥–∫–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ –∫–æ–ª–æ–Ω–æ–∫ –≤ –≤–∞—à–µ–º Excel-—Ñ–∞–π–ª–µ (–ø–µ—Ä–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ = 0, –≤—Ç–æ—Ä–∞—è = 1, –∏ —Ç.–¥.).

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É
```bash
python main.py "source\N1_180725_20510595.xls"
```

### –ó–∞–ø—É—Å–∫ —Å —Ñ–∞–π–ª–æ–º –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
```bash
python main.py
```

### –°–ø—Ä–∞–≤–∫–∞
```bash
python main.py -h
```

## –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ç–æ–≥–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞–±–æ—Ç—ã (—É—Å–ø–µ—Ö –∏–ª–∏ –æ—à–∏–±–∫–∞) –≤ Telegram-–≥—Ä—É–ø–ø—É —á–µ—Ä–µ–∑ –±–æ—Ç–∞.

- –î–ª—è —Ä–∞–±–æ—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–µ `.env` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–¥–∞–Ω—ã:
  - `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞
  - `BOT_CHAT_ID` ‚Äî ID —á–∞—Ç–∞ (–≥—Ä—É–ø–ø—ã)
  - `BOT_THREAD_ID` ‚Äî ID —Ç–µ–º—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–º—ã –≤ –≥—Ä—É–ø–ø–µ)

**–§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π:**
- –ü—Ä–∏ —É—Å–ø–µ—Ö–µ:
  ```
  ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
  üìé<b>–§–∞–π–ª:</b><i>–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞</i>
  ```
- –ü—Ä–∏ –æ—à–∏–±–∫–µ:
  ```
  ‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
  üìé<b>–û—à–∏–±–∫–∞:</b><i>–¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –∏–ª–∏ –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞</i>
  ```

–°–æ–æ–±—â–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è –≤ HTML –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Telegram —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º.

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∏ –æ—à–∏–±–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª `app.log` –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UTF-8.
- –í —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ.

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

–°–∫—Ä–∏–ø—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–¥–∞—á—É –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:

```bash
python main.py "source\N1_180725_20510595.xls"
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å Excel-—Ñ–∞–π–ª–∞–º–∏ (.xls) –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.
- –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –¥–µ–π—Å—Ç–≤—É—é—â–∏–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—É—Ç—å –∏–∑ config.json.

---

**–í–Ω–∏–º–∞–Ω–∏–µ!** –ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ —Å–≤–æ–∏ –ª–æ–≥–∏–Ω—ã –∏ –ø–∞—Ä–æ–ª–∏ —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º. –•—Ä–∞–Ω–∏—Ç–µ `.env` –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

